<!DOCTYPE html>
<html lang="en" dir="ltr" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Control Valves Log</title>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&family=Roboto:wght@400;500;700;900&family=Roboto+Mono:wght@500;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --kipic-navy: #002F6C; --kipic-green: #6FAE27;
            --kipic-gradient: linear-gradient(135deg, var(--kipic-navy) 60%, #004494 100%);
            --bg-body: #f3f5f8; --bg-card: #ffffff; --text-main: #2c3e50;
            --text-muted: #6c757d; --border-color: #e9ecef; --header-text: #ffffff;
            --table-label-bg: #f8f9fa; --table-label-text: #495057; --table-val-bg: #ffffff;
            --input-bg: #ffffff; --input-border: #ced4da; --footer-bg: #e9ecef;
            --badge-bg: var(--kipic-navy); --badge-text: #ffffff;
            --status-ok: #198754; --status-no: #dc3545;
        }
        [data-theme="dark"] {
            --bg-body: #121212; --bg-card: #1e1e24; --text-main: #e0e0e0;
            --text-muted: #a0a0a0; --border-color: #343a40; --header-text: #e0e0e0;
            --table-label-bg: #252530; --table-label-text: #ced4da; --table-val-bg: #1e1e24;
            --input-bg: #2b2b36; --input-border: #495057; --footer-bg: #1a1a1a;
            --kipic-navy: #0d1b2a; --kipic-green: #7bc938;
            --badge-bg: var(--kipic-green); --badge-text: #000000;
            --status-ok: #2ecc71; --status-no: #e74c3c;
        }
        body { font-family: 'Roboto', 'Tajawal', sans-serif; background-color: var(--bg-body); color: var(--text-main); min-height: 100vh; display: flex; flex-direction: column; transition: background-color 0.3s ease, color 0.3s ease; }
        .main-header { background: var(--kipic-gradient); color: var(--header-text); padding: 1.5rem 2rem; position: relative; box-shadow: 0 4px 15px rgba(0,0,0,0.15); text-align: center; border-bottom: 4px solid var(--kipic-green); }
        .header-title-main { font-weight: 800; font-size: 1.8rem; letter-spacing: 0.5px; text-transform: uppercase; }
        .header-subtitle { font-weight: 400; font-size: 1.1rem; opacity: 0.9; margin-top: 4px; color: #d1e7dd; }
        .header-controls { position: absolute; top: 50%; transform: translateY(-50%); inset-inline-end: 25px; display: flex; gap: 12px; align-items: center; direction: ltr !important; }
        .icon-btn { background: rgba(255,255,255,0.15); border: 1px solid rgba(255,255,255,0.25); color: #fff; border-radius: 8px; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.2s; }
        .icon-btn:hover { background: var(--kipic-green); border-color: var(--kipic-green); }
        .lang-switch-container { background: rgba(0, 0, 0, 0.2); border: 1px solid rgba(255, 255, 255, 0.3); border-radius: 20px; padding: 2px; display: flex; position: relative; cursor: pointer; width: 76px; height: 34px; }
        .lang-option { flex: 1; text-align: center; font-size: 0.75rem; font-weight: 700; z-index: 2; line-height: 28px; color: rgba(255, 255, 255, 0.6); transition: color 0.3s; }
        .lang-option.active { color: #fff; }
        .lang-slider { position: absolute; top: 2px; bottom: 2px; left: 2px; width: 50%; background: var(--kipic-green); border-radius: 16px; transition: transform 0.3s ease; z-index: 1; }
        .lang-switch-container.ar-active .lang-slider { transform: translateX(92%); }
        .card { background-color: var(--bg-card); border: none; border-radius: 12px; box-shadow: 0 2px 12px rgba(0,0,0,0.06); margin-bottom: 20px; border-top: 3px solid var(--kipic-navy); transition: border-color 0.3s ease; }
        [data-theme="dark"] .card { border-top-color: var(--kipic-green) !important; }
        .card-header-custom { display: flex; align-items: center; padding: 12px 20px; border-bottom: 1px solid var(--border-color); }
        .card-title-text { color: var(--kipic-navy); font-weight: 700; margin: 0; font-size: 1rem; display: flex; align-items: center; gap: 10px; }
        [data-theme="dark"] .card-title-text { color: var(--kipic-green); }
        .form-label { color: var(--text-muted); font-size: 0.8rem; font-weight: 700; margin-bottom: 8px; display: flex; align-items: center; gap: 8px; }
        .label-icon { color: var(--kipic-green); font-size: 1.1rem; }
        .form-select { background-color: var(--input-bg); color: var(--text-main); border: 1px solid var(--input-border); padding: 10px 12px; border-radius: 8px; font-size: 0.95rem; height: 46px; transition: all 0.3s; }
        .form-select:focus { border-color: var(--kipic-green); box-shadow: 0 0 0 3px rgba(111, 174, 39, 0.15); }
        .form-select:disabled { background-color: var(--bg-body); color: var(--text-muted); opacity: 0.6; border-color: var(--border-color); }
        [dir="rtl"] .form-select { background-position: left 0.75rem center; }
        .table { margin-bottom: 0; border-color: var(--border-color); color: var(--text-main); }
        .table tbody th { background-color: var(--table-label-bg); color: var(--table-label-text); font-weight: 600; font-size: 0.85rem; padding: 14px 15px; border-bottom: 1px solid var(--border-color); width: 35%; vertical-align: middle; }
        .table tbody td { background-color: var(--table-val-bg); padding: 14px 15px; vertical-align: middle; border-bottom: 1px solid var(--border-color); color: var(--text-main); font-size: 0.95rem; font-weight: 500; }
        .tag-badge { background-color: var(--badge-bg); color: var(--badge-text); padding: 5px 12px; border-radius: 6px; font-family: 'Roboto Mono', monospace; font-weight: 700; letter-spacing: 1px; }
        .status-icon-only { font-size: 1.5rem; line-height: 1; }
        .icon-ok { color: var(--status-ok) !important; } .icon-no { color: var(--status-no) !important; }
        .no-data { text-align: center; padding: 50px 20px; color: var(--text-muted); font-style: italic; }
        .site-footer { margin-top: auto; background-color: var(--footer-bg); border-top: 1px solid var(--border-color); padding: 20px 0; font-size: 0.8rem; color: var(--text-muted); text-align: center; }
        @media (max-width: 768px) {
            .main-header { padding: 1rem 1.2rem; } .header-title-main { font-size: 1.3rem; } .header-subtitle { font-size: 0.9rem; }
            .header-controls { position: static; transform: none; margin-top: 10px; justify-content: center; }
            #theme-toggle-btn { display: none !important; } .table tbody th { width: 40%; font-size: 0.8rem; }
        }
    </style>
</head>
<body>

<header class="main-header">
    <div class="container-fluid p-0">
        <div class="row align-items-center justify-content-center position-relative">
            <div class="col-12 text-center">
                <div class="header-title-main" data-i18n="mainTitle">Control Valves Log</div>
                <div class="header-subtitle" data-i18n="subTitle">Technical Inquiry System</div>
            </div>
            <div class="header-controls">
                <button class="icon-btn" id="theme-toggle-btn" onclick="toggleThemeManual()" title="Switch Theme">
                    <i class="bi bi-sun-fill" id="theme-icon"></i>
                </button>
                <div class="lang-switch-container" id="lang-switch" onclick="toggleLanguage()">
                    <div class="lang-slider"></div>
                    <span class="lang-option active" id="opt-en">EN</span>
                    <span class="lang-option" id="opt-ar">AR</span>
                </div>
            </div>
        </div>
    </div>
</header>

<div class="container py-4 py-md-5">
    <div class="card p-3 p-md-4">
        <div class="row g-3 align-items-end justify-content-center">
            <div class="col-md-5">
                <label class="form-label"><i class="bi bi-funnel label-icon"></i><span data-i18n="lblType">Valve Type</span></label>
                <select class="form-select" id="controlType" onchange="populateNumbers()"></select>
            </div>
            <div class="col-md-5">
                <label class="form-label"><i class="bi bi-tag label-icon"></i><span data-i18n="lblTag">Number</span></label>
                <select class="form-select" id="controlNumber" onchange="showData()" disabled></select>
            </div>
        </div>
    </div>

    <div class="card" id="results-card">
        <div class="card-header-custom">
            <h5 class="card-title-text"><i class="bi bi-clipboard-data"></i><span data-i18n="dataHeader">Technical Data</span></h5>
        </div>
        <div class="card-body p-0 table-responsive">
            <div id="placeholder" class="no-data" data-i18n="placeholder">Please select valve type and tag number...</div>
            <table id="dataTable" class="table table-hover" style="display: none;">
                <tbody id="tableBody"></tbody>
            </table>
        </div>
    </div>
</div>

<footer class="site-footer">
    <div class="container"><span data-i18n="footerText">Plant Operations Dept. © 2025</span></div>
</footer>

<script>
    // --- TRANSLATIONS (FIXED & ACCURATE) ---
    const translations = {
        ar: {
            mainTitle: "سجل صمامات التحكم", subTitle: "نظام الاستعلام الفني",
            lblType: "نوع الصمام", lblTag: "رقم التاق (Tag No)",
            optSelect: "-- اختر النوع --", optSelectNum: "-- اختر الرقم --",
            placeholder: "يرجى اختيار نوع الصمام ورقمه لعرض البيانات",
            dataHeader: "البيانات الفنية والموقع", footerText: "قسم عمليات المصنع © 2025",
            h_tag: "رقم التاق", h_service: "وصف الخدمة / الخط",
            h_action: "وضع الفشل (Failure Mode)", h_handjack: "تشغيل يدوي (Hand Jack)",
            h_pefs: "رقم المخطط (PEFS)", h_location: "الموقع الميداني",
            actions: { FC: "مغلق (Fail Close)", FO: "مفتوح (Fail Open)", FL: "ثابت (Fail Lock)", "-": "-" },
            types: { FV: "صمام تدفق (Flow)", HV: "صمام يدوي (Hand)", LV: "صمام مستوى (Level)", PDV: "صمام فرق ضغط (Diff. Press)", PV: "صمام ضغط (Pressure)", TV: "صمام حرارة (Temp)" }
        },
        en: {
            mainTitle: "Control Valves Log", subTitle: "Technical Inquiry System",
            lblType: "Valve Type", lblTag: "Tag Number",
            optSelect: "-- Select Type --", optSelectNum: "-- Select Number --",
            placeholder: "Please select valve type and tag number...",
            dataHeader: "Technical Data", footerText: "Plant Operations Dept. © 2025",
            h_tag: "Tag No.", h_service: "Service Description",
            h_action: "Failure Action", h_handjack: "Hand Jack / Bypass",
            h_pefs: "PEFS No.", h_location: "Location",
            actions: { FC: "Close", FO: "Open", FL: "Lock", "-": "N/A" },
            types: { FV: "Flow Valve", HV: "Hand Valve", LV: "Level Valve", PDV: "Diff. Pressure Valve", PV: "Pressure Valve", TV: "Temp. Valve" }
        }
    };

    // --- DATABASE (FULL DETAILS) ---
    const database = [
        { t: "FV", n: "01-FV-00001",  act: "FC", hj: "YES", pefs: "J-001",      s_en: "RETURN OIL SLOPS TO CRUDE FEED PUMP P-001A/B", s_ar: "خط إرجاع الزيوت المرتجعة (Slops) إلى مضخة تغذية الخام P-001A/B", l_en: "NEAR CRUDE FEED PUMP P-001A/B", l_ar: "بجانب مضخة تغذية الخام P-001A/B" },
        { t: "FV", n: "01-FV-00002",  act: "FC", hj: "YES", pefs: "J-001",      s_en: "CRUDE FEED FROM CRUDE FEED PUMP P-0001A/B", s_ar: "تغذية الخام من مضخة التلقيم P-0001A/B", l_en: "NEAR DEMULSIFIER INJECTION PACKAGE", l_ar: "بجانب وحدة حقن مانع الاستحلاب (Demulsifier)" },
        { t: "FV", n: "01-FV-00005",  act: "FO", hj: "YES", pefs: "J-001",      s_en: "CRUDE FEED PUMP (P-0001) MIN FLOW", s_ar: "خط التدفق الأدنى (Min Flow) لمضخة الخام P-0001", l_en: "NEAR CRUDE FEED PUMP P-001A/B", l_ar: "بجانب مضخة تغذية الخام P-001A/B" },
        { t: "FV", n: "01-FV-00006",  act: "FC", hj: "YES", pefs: "J-010-002", s_en: "P-0021 A/B MINIMUM FLOW BYPASS", s_ar: "تجاوز التدفق الأدنى (Min Flow Bypass) للمضخة P-0021 A/B", l_en: "P-0021 A/B STRUCTURE FIRST FLOOR", l_ar: "منصة المضخة P-0021 A/B - الدور الأول" },
        { t: "FV", n: "01-FV-00014",  act: "FC", hj: "NO",  pefs: "J-007-002", s_en: "EFFLUENT WATER FROM MUD WASH PUMPS", s_ar: "المياه الخارجة (Effluent) من مضخات غسيل الطين", l_en: "NEAR PUMP P-0027A", l_ar: "بجانب المضخة P-0027A" },
        { t: "FV", n: "01-FV-00021A", act: "FL", hj: "YES", pefs: "J-015",      s_en: "FLASHED CRUDE PASS 1 TO CRUDE HEATER", s_ar: "الخام (مرحلة الوميض - المسار 1) إلى السخان", l_en: "HEATER STRUCTURE NO.4 TOP FLOOR", l_ar: "هيكل السخان رقم 4 - الدور العلوي" },
        { t: "FV", n: "01-FV-00021B", act: "FL", hj: "YES", pefs: "J-015",      s_en: "FLASHED CRUDE PASS 2 TO CRUDE HEATER", s_ar: "الخام (مرحلة الوميض - المسار 2) إلى السخان", l_en: "HEATER STRUCTURE NO.4 TOP FLOOR", l_ar: "هيكل السخان رقم 4 - الدور العلوي" },
        { t: "FV", n: "01-FV-00021C", act: "FL", hj: "YES", pefs: "J-015",      s_en: "FLASHED CRUDE PASS 3 TO CRUDE HEATER", s_ar: "الخام (مرحلة الوميض - المسار 3) إلى السخان", l_en: "HEATER STRUCTURE NO.4 TOP FLOOR", l_ar: "هيكل السخان رقم 4 - الدور العلوي" },
        { t: "FV", n: "01-FV-00021D", act: "FL", hj: "YES", pefs: "J-015",      s_en: "FLASHED CRUDE PASS 4 TO CRUDE HEATER", s_ar: "الخام (مرحلة الوميض - المسار 4) إلى السخان", l_en: "HEATER STRUCTURE NO.4 TOP FLOOR", l_ar: "هيكل السخان رقم 4 - الدور العلوي" },
        { t: "FV", n: "01-FV-00021E", act: "FL", hj: "YES", pefs: "J-015",      s_en: "FLASHED CRUDE PASS 5 TO CRUDE HEATER", s_ar: "الخام (مرحلة الوميض - المسار 5) إلى السخان", l_en: "HEATER STRUCTURE NO.4 TOP FLOOR", l_ar: "هيكل السخان رقم 4 - الدور العلوي" },
        { t: "FV", n: "01-FV-00021F", act: "FL", hj: "YES", pefs: "J-015",      s_en: "FLASHED CRUDE PASS 6 TO CRUDE HEATER", s_ar: "الخام (مرحلة الوميض - المسار 6) إلى السخان", l_en: "HEATER STRUCTURE NO.4 TOP FLOOR", l_ar: "هيكل السخان رقم 4 - الدور العلوي" },
        { t: "FV", n: "01-FV-00021G", act: "FL", hj: "YES", pefs: "J-015",      s_en: "FLASHED CRUDE PASS 7 TO CRUDE HEATER", s_ar: "الخام (مرحلة الوميض - المسار 7) إلى السخان", l_en: "HEATER STRUCTURE NO.4 TOP FLOOR", l_ar: "هيكل السخان رقم 4 - الدور العلوي" },
        { t: "FV", n: "01-FV-00021H", act: "FL", hj: "YES", pefs: "J-015",      s_en: "FLASHED CRUDE PASS 8 TO CRUDE HEATER", s_ar: "الخام (مرحلة الوميض - المسار 8) إلى السخان", l_en: "HEATER STRUCTURE NO.4 TOP FLOOR", l_ar: "هيكل السخان رقم 4 - الدور العلوي" },
        { t: "FV", n: "01-FV-00022",  act: "FC", hj: "YES", pefs: "J-017",      s_en: "REFINERY FUEL GAS FROM DISTRIBUTION HEADER", s_ar: "غاز وقود المصفاة (Fuel Gas) من مجمع التوزيع الرئيسي", l_en: "NEAR DECOKING DRUM (SOUTH SIDE)", l_ar: "بجانب وعاء إزالة التفحم (جنوب)" },
        { t: "FV", n: "01-FV-00023",  act: "FC", hj: "YES", pefs: "J-017",      s_en: "PLANT FUEL OIL SUPPLY FROM DISTRIBUTION HEADER", s_ar: "إمداد زيت الوقود (Fuel Oil) من المجمع الرئيسي", l_en: "HEATER GROUND FLOOR (WEST SIDE)", l_ar: "السخان - الدور الأرضي (غرب)" },
        { t: "FV", n: "01-FV-00026",  act: "FL", hj: "NO",  pefs: "J-019",      s_en: "INTAKE AIR TO COMBUSTION AIR BLOWER", s_ar: "سحب الهواء إلى منفاخ هواء الاحتراق (Combustion Blower)", l_en: "FD FAN SUCTION LINE", l_ar: "خط السحب لمروحة الدفع (FD Fan)" },
        { t: "FV", n: "01-FV-00027",  act: "FO", hj: "YES", pefs: "J-023",      s_en: "REFLUX TO CRUDE DISTILLATION COLUMN C-0001", s_ar: "خط الارتجاع (Reflux) لبرج تقطير الخام C-0001", l_en: "V-0004 STRUCTURE 8TH FLOOR", l_ar: "منصة V-0004 الدور الثامن" },
        { t: "FV", n: "01-FV-00028",  act: "FO", hj: "YES", pefs: "J-023",      s_en: "MIDDLE Pump Around TO CRUDE DISTILLATION COLUMN C-0001", s_ar: "خط التدوير الأوسط (Middle PA) لبرج التقطير C-0001", l_en: "V-0004 STRUCTURE 4TH FLOOR", l_ar: "منصة V-0004 الدور الرابع" },
        { t: "FV", n: "01-FV-00029",  act: "FO", hj: "YES", pefs: "J-023",      s_en: "TOP Pump Around TO CRUDE DISTILLATION COLUMN C-0001", s_ar: "خط التدوير العلوي (Top PA) لبرج التقطير C-0001", l_en: "V-0004 STRUCTURE 6TH FLOOR", l_ar: "منصة V-0004 الدور السادس" },
        { t: "FV", n: "01-FV-00030",  act: "FO", hj: "YES", pefs: "J-023",      s_en: "BOTTOM Pump Around TO CRUDE DISTILLATION COLUMN C-0001", s_ar: "خط التدوير السفلي (Bottom PA) لبرج التقطير C-0001", l_en: "V-0004 STRUCTURE 4TH FLOOR", l_ar: "منصة V-0004 الدور الرابع" },
        { t: "FV", n: "01-FV-00031",  act: "FC", hj: "YES", pefs: "J-024",      s_en: "STRIPPING STM TO CRD DISTILLATION COLUMN C-0001", s_ar: "بخار التجريد (Stripping Steam) لبرج التقطير C-0001", l_en: "HEAVY DIESEL STREEPER GROUND FLOOR", l_ar: "برج تجريد الديزل الثقيل - الأرضي" },
        { t: "FV", n: "01-FV-00032",  act: "FC", hj: "YES", pefs: "J-029",      s_en: "WASH WATER FROM SOUR WATER PUMP", s_ar: "مياه الغسيل من مضخة المياه الحمضية (Sour Water Pump)", l_en: "V-0004 STRUCTURE 6TH FLOOR", l_ar: "منصة V-0004 الدور السادس" },
        { t: "FV", n: "01-FV-00036",  act: "FC", hj: "YES", pefs: "J-033",      s_en: "STRIP STEAM TO C-0003", s_ar: "بخار التجريد إلى البرج C-0003", l_en: "V-0004 STRUCTURE 3RD FLOOR", l_ar: "منصة V-0004 الدور الثالث" },
        { t: "FV", n: "01-FV-00037",  act: "FC", "hj": "YES", "pefs": "J-035", "s_en": "HEAVY DIESEL PRODUCT TO E-0008", "s_ar": "منتج الديزل الثقيل إلى المبادل E-0008", "l_en": "NEAR P-00118", "l_ar": "بجانب المضخة P-00118" },
        { t: "FV", n: "01-FV-00038",  act: "FO", "hj": "YES", "pefs": "J-038-002", "s_en": "UNSTABILIZD NAPHTHA TO NAPHTHA STABILIZER", "s_ar": "النافثا غير المستقرة إلى برج التثبيت (Naphtha Stabilizer)", "l_en": "NEAR P-0015A (SOUTH SIDE)", "l_ar": "بجانب P-0015A (جنوب)" },
        { t: "FV", n: "01-FV-00039",  act: "FC", "hj": "NO", "pefs": "J-040-002", "s_en": "SOUR LPG PRODUCT TO SGU", "s_ar": "منتج الغاز المسال الحامض (Sour LPG) إلى وحدة SGU", "l_en": "NEAR P-0016A (WEST SIDE)", "l_ar": "بجانب P-0016A (غرب)" },
        { t: "FV", n: "01-FV-00041",  act: "FC", "hj": "YES", "pefs": "J-010-001", "s_en": "STRIPPING STEAM TO PREHEATER E-0013C", "s_ar": "بخار التجريد إلى المسخن الأولي E-0013C", "l_en": "NEAR E-0013D", "l_ar": "بجانب E-0013D" },
        { t: "FV", n: "01-FV-00042",  act: "FC", "hj": "YES", "pefs": "J-010-003", "s_en": "STRIPPD SOUR WTR TO CRD FEED/OVHD EXCH", "s_ar": "المياه الحمضية المجردة إلى المبادل الحراري", "l_en": "NORTH SIDE OF E-0013B", "l_ar": "شمال E-0013B" },
        { t: "FV", n: "01-FV-00045",  act: "FO", "hj": "YES", "pefs": "J-041-002", "s_en": "ATM RESIDUE FROM RESIDUE EXCHANGER E-0006", "s_ar": "مخلفات التقطير الجوي (Atm Residue) من المبادل E-0006", "l_en": "NORTH SIDE OF V-0015", "l_ar": "شمال V-0015" },
        { t: "FV", n: "01-FV-00054",  act: "FO", "hj": "YES", "pefs": "J-039-001", "s_en": "NAPHTHA STABILI REFLUX TO NAPHTHA STAB", "s_ar": "ارتجاع النافثا (Reflux) إلى برج التثبيت", "l_en": "STABILIZER COLUMN TOP FLOOR", "l_ar": "برج التثبيت - الدور العلوي" },
        { t: "FV", n: "01-FV-00057",  act: "FO", "hj": "YES", "pefs": "J-039-001", "s_en": "STAB NAPHTHA PROD FM STAB NAPHTHA PMP P-0017 A/B", "s_ar": "منتج النافثا المثبتة من المضخة P-0017 A/B", "l_en": "STABILIZER STRUCTURE 1ST FLOOR", "l_ar": "منصة المثبت - الدور الأول" },
        { t: "FV", n: "01-FV-00063",  act: "FC", "hj": "YES", "pefs": "J-034", "s_en": "HOT DIESEL PRODUCT TO DHT-03", "s_ar": "منتج الديزل الحار إلى وحدة DHT-03", "l_en": "NORTH SIDE OF E-0017", "l_ar": "شمال E-0017" },
        { t: "FV", n: "01-FV-00064",  act: "FC", "hj": "YES", "pefs": "J-034", "s_en": "DSL PROD TO DIESEL PROD AIR COOLER E-0042A", "s_ar": "منتج الديزل إلى مبرد الهواء E-0042A", "l_en": "NORTH SIDE OF E-0017 IN RACK", "l_ar": "شمال E-0017 (Pipe Rack)" },
        { t: "FV", n: "01-FV-00073",  act: "FO", "hj": "YES", "pefs": "J-029-002", "s_en": "WASH WATER FROM SOUR WATER PUMP P-0008A/B", "s_ar": "مياه الغسيل من مضخة المياه الحمضية P-0008A/B", "l_en": "V-0004 STRUCTURE 6TH FLOOR", "l_ar": "منصة V-0004 الدور السادس" },
        { t: "FV", n: "01-FV-00100",  act: "FC", "hj": "YES", "pefs": "J-035", "s_en": "STRIPPING STRM TO HEAVY DIESEL STRIPPER", "s_ar": "بخار التجريد إلى برج تجريد الديزل الثقيل", "l_en": "HEAVY DIESEL STREEPER GROUND FLOOR", "l_ar": "برج تجريد الديزل الثقيل - الأرضي" },
        { t: "FV", n: "01-FV-00102",  act: "FC", "hj": "YES", "pefs": "J-030", "s_en": "DISCHARGE OF PUMP 01-P-0007 A/B MIN FLOW", "s_ar": "خط التدفق الأدنى (Min Flow) للمضخة 01-P-0007 A/B", "l_en": "C-0002/3 STRUCTURE TOP FLOOR", "l_ar": "منصة C-0002/3 الدور العلوي" },
        { t: "FV", n: "01-FV-00103",  act: "FC", "hj": "YES", "pefs": "J-033", "s_en": "LT DIESEL PRODUCT TO E-0008", "s_ar": "منتج الديزل الخفيف إلى المبادل E-0008", "l_en": "C-0002/3 STRUCTURE TOP FLOOR", "l_ar": "منصة C-0002/3 الدور العلوي" },
        { t: "FV", n: "01-FV-00115",  act: "FO", "hj": "YES", "pefs": "J-039-001", "s_en": "BOT. Pump Around BYPASS TO STABILIZER C-0005", "s_ar": "خط تجاوز (Bypass) لتدوير المثبت السفلي C-0005", "l_en": "NEAR NAPHTHA STABILIZER COLUMN", "l_ar": "بجانب برج تثبيت النافثا" },
        { t: "FV", n: "01-FV-00116",  act: "FO", "hj": "YES", "pefs": "J-033", "s_en": "LT DIESEL PRODUCT TO 01-C-0003 BY PASS", "s_ar": "خط تجاوز (Bypass) لمنتج الديزل الخفيف إلى C-0003", "l_en": "C-0002/3 STRUCTURE TOP FLOOR", "l_ar": "منصة C-0002/3 الدور العلوي" },
        { t: "FV", n: "01-FV-00150",  act: "FC", "hj": "YES", "pefs": "J-041-002", "s_en": "COLD NAPHTHA PROD FM NAPHTHA PROD CLR", "s_ar": "منتج النافثا البارد الخارج من المبرد", "l_en": "NORTH SIDE OF E-0018", "l_ar": "شمال E-0018" },
        { t: "FV", n: "01-FV-00180A", act: "FL", "hj": "YES", "pefs": "J-015", "s_en": "PRG STM TO XOVR SECTION CRD HEATER PASS 1", "s_ar": "بخار التطهير (Purge Steam) لسخان الخام (Pass 1)", "l_en": "HEATER STRUCTURE NO.4 TOP FLOOR", "l_ar": "هيكل السخان 4 الدور العلوي" },
        { t: "FV", n: "01-FV-00180B", act: "FL", "hj": "YES", "pefs": "J-015", "s_en": "PRG STM TO XOVR SECTION CRD HEATER PASS 2", "s_ar": "بخار التطهير (Purge Steam) لسخان الخام (Pass 2)", "l_en": "HEATER STRUCTURE NO.4 TOP FLOOR", "l_ar": "هيكل السخان 4 الدور العلوي" },
        { t: "FV", n: "01-FV-00180C", act: "FL", "hj": "YES", "pefs": "J-015", "s_en": "PRG STM TO XOVR SECTION CRD HEATER PASS 3", "s_ar": "بخار التطهير (Purge Steam) لسخان الخام (Pass 3)", "l_en": "HEATER STRUCTURE NO.4 TOP FLOOR", "l_ar": "هيكل السخان 4 الدور العلوي" },
        { t: "FV", n: "01-FV-00180D", act: "FL", "hj": "YES", "pefs": "J-015", "s_en": "PRG STM TO XOVR SECTION CRD HEATER PASS 4", "s_ar": "بخار التطهير (Purge Steam) لسخان الخام (Pass 4)", "l_en": "HEATER STRUCTURE NO.4 TOP FLOOR", "l_ar": "هيكل السخان 4 الدور العلوي" },
        { t: "FV", n: "01-FV-00180E", act: "FL", "hj": "YES", "pefs": "J-015", "s_en": "PRG STM TO XOVR SECTION CRD HEATER PASS 5", "s_ar": "بخار التطهير (Purge Steam) لسخان الخام (Pass 5)", "l_en": "HEATER STRUCTURE NO.4 TOP FLOOR", "l_ar": "هيكل السخان 4 الدور العلوي" },
        { t: "FV", n: "01-FV-00180F", act: "FL", "hj": "YES", "pefs": "J-015", "s_en": "PRG STM TO XOVR SECTION CRD HEATER PASS 6", "s_ar": "بخار التطهير (Purge Steam) لسخان الخام (Pass 6)", "l_en": "HEATER STRUCTURE NO.4 TOP FLOOR", "l_ar": "هيكل السخان 4 الدور العلوي" },
        { t: "FV", n: "01-FV-00180G", act: "FL", "hj": "YES", "pefs": "J-015", "s_en": "PRG STM TO XOVR SECTION CRD HEATER PASS 7", "s_ar": "بخار التطهير (Purge Steam) لسخان الخام (Pass 7)", "l_en": "HEATER STRUCTURE NO.4 TOP FLOOR", "l_ar": "هيكل السخان 4 الدور العلوي" },
        { t: "FV", n: "01-FV-00180H", act: "FL", "hj": "YES", "pefs": "J-015", "s_en": "PRG STM TO XOVR SECTION CRD HEATER PASS 8", "s_ar": "بخار التطهير (Purge Steam) لسخان الخام (Pass 8)", "l_en": "HEATER STRUCTURE NO.4 TOP FLOOR", "l_ar": "هيكل السخان 4 الدور العلوي" },
        { t: "FV", n: "01-FV-00200",  act: "FC", "hj": "YES", "pefs": "J-031-002", "s_en": "KEROSENE FROM STRIPPER TO FILTER 01-F-0004", "s_ar": "الكيروسين من برج التجريد إلى الفلتر 01-F-0004", "l_en": "NEAR E-0006A/B (SOUTH SIDE)", "l_ar": "بجانب E-0006A/B (جنوب)" },
        { t: "HV", n: "01-HV-00022",  act: "FO", "hj": "YES", "pefs": "J-009-001", "s_en": "DESALTED CRUDE FROM 2ND STAGE DESALTER", "s_ar": "نفط خام منزوع الأملاح من المرحلة الثانية", "l_en": "NORTH SIDE OF V-0001", "l_ar": "شمال V-0001" },
        { t: "HV", n: "01-HV-00030",  act: "FO", "hj": "YES", "pefs": "J-009-001", "s_en": "ATH RESIDUE BYPASS TO EXCHANGER E-0012", "s_ar": "خط تجاوز (Bypass) لمخلفات التقطير إلى المبادل E-0012", "l_en": "NEAR E-0012E/F (SOUTH SIDE)", "l_ar": "بجانب E-0012E/F (جنوب)" },
        { t: "HV", n: "01-HV-00125",  act: "-", "hj": "NO",  "pefs": "J-014-003", "s_en": "DIESEL PRODUCT AIR COOLER 01-E-0042A", "s_ar": "مبرد هواء الديزل 01-E-0042A", "l_en": "FIN FAN STRUCTURE NEAR E-0042", "l_ar": "منصة المبردات الهوائية بجانب E-0042" },
        { t: "HV", n: "01-HV-00126",  act: "-", "hj": "NO",  "pefs": "J-034", "s_en": "DIESEL PRODUCT AIR COOLER 01-E-0042A", "s_ar": "مبرد هواء الديزل 01-E-0042A", "l_en": "FIN FAN STRUCTURE NEAR E-0042", "l_ar": "منصة المبردات الهوائية بجانب E-0042" },
        { t: "HV", n: "01-HV-00230",  act: "-", "hj": "NO",  "pefs": "J-002-002", "s_en": "CRUDE FEED FROM CRUDE FEED PUMP", "s_ar": "تغذية النفط الخام من المضخة الرئيسية", "l_en": "V-0004 STRUCTURE 5TH FLOOR", "l_ar": "منصة V-0004 الدور الخامس" },
        { t: "LV", n: "01-LV-00002",  act: "-", "hj": "NO",  "pefs": "J-002-002", "s_en": "EFL WTR TO DESALTER EFL WTR FLASH DRUM", "s_ar": "المياه الخارجة إلى وعاء وميض المياه (Flash Drum)", "l_en": "NEAR P-0014A", "l_ar": "بجانب P-0014A" },
        { t: "LV", n: "01-LV-00005",  act: "FC", "hj": "YES", "pefs": "J-005", "s_en": "WASH WATER FM DESALTER WASH WATER PUMP P-0013A/B", "s_ar": "مياه الغسيل من مضخة P-0013A/B", "l_en": "BETWEEN V-0001 & V-0002", "l_ar": "بين V-0001 و V-0002" },
        { t: "LV", n: "01-LV-00018",  act: "FC", "hj": "YES", "pefs": "J-029-002", "s_en": "SOUR WATER TO SOUR WATER STRIPPER", "s_ar": "المياه الحمضية إلى برج التجريد (SWS)", "l_en": "NEAR P-0008B", "l_ar": "بجانب P-0008B" },
        { t: "LV", n: "01-LV-00019",  act: "FC", "hj": "YES", "pefs": "J-031-001", "s_en": "KEROSENE TO KEROSENE STRIPPER", "s_ar": "الكيروسين إلى برج تجريد الكيروسين", "l_en": "V-0004 STRUCTURE 2ND FLOOR", "l_ar": "منصة V-0004 الدور الثاني" },
        { t: "LV", n: "01-LV-00021",  act: "FC", "hj": "YES", "pefs": "J-033", "s_en": "LIGHT DIESEL TO LIGHT DIESEL STRIPPER", "s_ar": "الديزل الخفيف إلى برج تجريد الديزل", "l_en": "V-0004 STRUCTURE 4TH FLOOR", "l_ar": "منصة V-0004 الدور الرابع" },
        { t: "LV", n: "01-LV-00023",  act: "FC", "hj": "YES", "pefs": "J-034", "s_en": "HEAVY DIESEL TO HEAVY DIESEL STRIPPER", "s_ar": "الديزل الثقيل إلى برج تجريد الديزل", "l_en": "V-0001 COLUMN STRUCTURE", "l_ar": "منصة البرج V-0001" },
        { t: "LV", n: "01-LV-00030",  act: "FO", "hj": "YES", "pefs": "J-040-001", "s_en": "SOR WATER FROM STAB OVERHD ACCUMULATOR", "s_ar": "المياه الحمضية من الوعاء العلوي للمثبت (Stabilizer Overhead)", "l_en": "STABILIZER STRUCTURE 1ST FLOOR", "l_ar": "منصة المثبت - الدور الأول" },
        { t: "LV", n: "01-LV-00048",  act: "FO", "hj": "YES", "pefs": "J-010-001", "s_en": "DESALTR EFL WTR FR DESALTR EFL AIR CLR E-0045A/B", "s_ar": "مياه مزيل الأملاح من مبرد الهواء E-0045A/B", "l_en": "FINFAN STRUCTURE WEST SIDE", "l_ar": "منصة المبردات (غرب)" },
        { t: "LV", n: "01-LV-00061",  act: "FC", "hj": "YES", "pefs": "J-010-002", "s_en": "EFLUENT WATER TO COMP SOUR WTR DRUM V-0016", "s_ar": "المياه الخارجة إلى وعاء المياه الحمضية V-0016", l_en: "P-0021 A/B STRUCTURE FIRST FLOOR", l_ar: "منصة المضخة P-0021 الدور الأول" },
        { t: "LV", n: "01-LV-00134",  act: "FC", "hj": "YES", "pefs": "J-024", "s_en": "BPA PUMPDOWN TO CRUDE DISTILLATION COLUMN", "s_ar": "تفريغ دائرة التدوير السفلية إلى برج التقطير (Pumpdown)", "l_en": "V-0004 STRUCTURE 4TH FLOOR", "l_ar": "منصة V-0004 الدور الرابع" },
        { t: "PDV", n: "01-PDV-00037", act: "FC", "hj": "NO", "pefs": "J-007-001", "s_en": "CRD FEED TO 1ST STG DSLTR STATIC MXR", "s_ar": "تغذية الخام إلى الخلاط الساكن (Static Mixer) مرحلة 1", "l_en": "BETWEEN V-0001 & V-0002", "l_ar": "بين V-0001 و V-0002" },
        { t: "PDV", n: "01-PDV-00086", act: "FO", "hj": "YES", "pefs": "J-017", "s_en": "NTRMDTE PRESSURE STEAM FROM DISTRIBUTION HEADER", "s_ar": "بخار متوسط الضغط (MP Steam) من مجمع التوزيع", "l_en": "HEATER GROUND FLOOR (WEST)", "l_ar": "السخان - الأرضي (غرب)" },
        { t: "PDV", n: "01-PDV-00107", act: "FO", "hj": "NO", "pefs": "J-009-001", "s_en": "CRD FEED TO 2ND STG DSLTR STATIC MXR", "s_ar": "تغذية الخام إلى الخلاط الساكن (Static Mixer) مرحلة 2", "l_en": "BETWEEN V-0001 & V-0002", "l_ar": "بين V-0001 و V-0002" },
        { t: "PV", n: "01-PV-00006",  act: "FC", "hj": "YES", "pefs": "J-013-001", "s_en": "PREFLASH VAPOR FROM CRUDE PREFLASH DRUM", "s_ar": "أبخرة الوميض من وعاء الوميض الأولي (Preflash Drum)", "l_en": "FINFAN STRUCTURE MIDDLE", "l_ar": "منصة المبردات (وسط)" },
        { t: "PV", n: "01-PV-00020",  act: "FO", "hj": "NO",  "pefs": "J-019", "s_en": "ON CRUDE HEATER F-0001", "s_ar": "على سخان النفط الخام F-0001", "l_en": "HEATER STACK", "l_ar": "مدخنة السخان" },
        { t: "PV", n: "01-PV-00092A", act: "FL", "hj": "NO",  "pefs": "J-019", "s_en": "REFINERY FG TO CRD OVERHEAD ACCUM", "s_ar": "غاز الوقود إلى المجمع العلوي (Overhead Accum)", "l_en": "ID FAN SUCTION LINE", "l_ar": "خط سحب مروحة ID" },
        { t: "PV", n: "01-PV-00112A", act: "FC", "hj": "YES", "pefs": "J-029-001", "s_en": "REFINERY FG TO CRD OVERHEAD ACCUM V-0004", "s_ar": "غاز الوقود إلى المجمع العلوي V-0004", "l_en": "V-0004 STRUCTURE 2ND FLOOR", "l_ar": "منصة V-0004 الدور الثاني" },
        { t: "PV", n: "01-PV-00112B", act: "FC", "hj": "YES", "pefs": "J-029-001", "s_en": "OFF GAS FROM CRD COL OVERHEAD ACCUM V-0004", "s_ar": "الغازات المنبعثة (Off Gas) من المجمع العلوي V-0004", "l_en": "V-0004 STRUCTURE 3RD FLOOR", "l_ar": "منصة V-0004 الدور الثالث" },
        { t: "PV", n: "01-PV-00121",  act: "FC", "hj": "YES", "pefs": "J-032", "s_en": "KEROSENE PRODUCT TO KHT-25", "s_ar": "منتج الكيروسين إلى وحدة KHT-25", "l_en": "B/L SOUTH SIDE", "l_ar": "حدود البطارية (B/L) - جنوب" },
        { t: "PV", n: "01-PV-00122",  act: "FC", "hj": "YES", "pefs": "J-032", "s_en": "KEROSENE PRODUCT TO KHT-25", "s_ar": "منتج الكيروسين إلى وحدة KHT-25", "l_en": "B/L SOUTH SIDE", "l_ar": "حدود البطارية (B/L) - جنوب" },
        { t: "PV", n: "01-PV-00148A", act: "FC", "hj": "YES", "pefs": "J-036", "s_en": "REFINERY FG TO OFFGAS COMP SUCT DRUM", "s_ar": "غاز الوقود إلى وعاء سحب الضاغط (Suction Drum)", "l_en": "V-0005 STRUCTURE TOP FLOOR", "l_ar": "منصة V-0005 الدور العلوي" },
        { t: "PV", n: "01-PV-00156",  act: "FC", "hj": "NO",  "pefs": "J-040-001", "s_en": "OVERHEAD FROM NAPHTHA STABILIZER C-0005", "s_ar": "الخط العلوي (Overhead) لمثبت النافثا C-0005", "l_en": "STABILIZER STRUCTURE TOP FLOOR", "l_ar": "منصة المثبت - الدور العلوي" },
        { t: "PV", n: "01-PV-00159",  act: "FC", "hj": "NO",  "pefs": "J-040-001", "s_en": "OVERHEAD FROM NAPHTHA STABILIZER C-0005", "s_ar": "الخط العلوي (Overhead) لمثبت النافثا C-0005", "l_en": "STABILIZER STRUCTURE TOP FLOOR", "l_ar": "منصة المثبت - الدور العلوي" },
        { t: "PV", n: "01-PV-00163A", act: "FC", "hj": "NO",  "pefs": "J-040-001", "s_en": "MP OFFGAS FROM STAB OVERHD ACCUM", "s_ar": "غازات (MP Offgas) من المجمع العلوي للمثبت", "l_en": "STABILIZER STRUCTURE TOP FLOOR", "l_ar": "منصة المثبت - الدور العلوي" },
        { t: "PV", n: "01-PV-00163B", act: "FC", "hj": "NO",  "pefs": "J-040-001", "s_en": "FLARE LOW PRESSURE FM STAB OVHD ACCUM", "s_ar": "إلى المشعل المنخفض (LP Flare) من المجمع العلوي للمثبت", "l_en": "NEAR COOLER E-0022", "l_ar": "بجانب المبرد E-0022" },
        { t: "PV", n: "01-PV-00188",  act: "FC", "hj": "YES", "pefs": "J-041-001", "s_en": "HOT NAPHTHA PRODUCT TO NHT-14", "s_ar": "منتج النافثا الحار إلى وحدة NHT-14", "l_en": "01MPR-05 28XA (RACK NORTH)", "l_ar": "حامل الأنابيب (Rack) الشمالي" },
        { t: "PV", n: "01-PV-00189",  act: "FC", "hj": "YES", "pefs": "J-041-001", "s_en": "HOT NAPHTHA PRODUCT TO NHT-14", "s_ar": "منتج النافثا الحار إلى وحدة NHT-14", "l_en": "01MPR-05 28XA (RACK NORTH)", "l_ar": "حامل الأنابيب (Rack) الشمالي" },
        { t: "PV", n: "01-PV-00232",  act: "FO", "hj": "YES", "pefs": "J-010-002", "s_en": "FLASHED VAPOUR FROM DESALTER EFL WTR", "s_ar": "أبخرة ومضية من مياه مزيل الأملاح", "l_en": "NEAR P-0014A", "l_ar": "بجانب P-0014A" },
        { t: "PV", n: "01-PV-00311",  act: "FO", "hj": "YES", "pefs": "J-036", "s_en": "FLR LOW PRESSURE FM OFFGAS COMP SUCT DRUM", "s_ar": "مشعل ضغط منخفض من وعاء سحب الضاغط", "l_en": "NEAR FLARE KO DRUM PUMP", "l_ar": "بجانب مضخة المشعل (KO Drum)" },
        { t: "PV", n: "01-PV-00398",  act: "FC", "hj": "YES", "pefs": "J-010-002", "s_en": "NITROGEN TO STRIPPED SOUR WATER DRUM", "s_ar": "نيتروجين إلى وعاء المياه الحمضية V-0016", "l_en": "V-0016 STRUCTURE TOP FLOOR", "l_ar": "منصة V-0016 الدور العلوي" },
        { t: "PV", n: "01-PV-00367",  act: "FC", "hj": "NO",  "pefs": "J-054-009", "s_en": "LP OFFGAS TO SGU", "s_ar": "غازات (LP Offgas) إلى وحدة SGU", "l_en": "NEAR P-00128", "l_ar": "بجانب P-00128" },
        { t: "TV", n: "01-TV-00050",  act: "FC", "hj": "YES", "pefs": "J-014-001", "s_en": "AR RYP FR CRD / AR EXCHANGER E-0010A/B/C/D", "s_ar": "مبادل حراري خام / مخلفات التقطير E-0010", "l_en": "V-0003 GROUND FLOOR", "l_ar": "V-0003 الأرضي" },
        { t: "TV", n: "01-TV-00061",  act: "FC", "hj": "YES", "pefs": "J-015", "s_en": "BOTTOM Pump Around FROM BOTTOMS PUMPAROUND PUMP P-0005A/B", "s_ar": "خط التدوير السفلي من المضخة P-0005A/B", "l_en": "NEAR FD FAN MOTOR", "l_ar": "بجانب محرك مروحة FD" },
        { t: "TV", n: "01-TV-00064",  act: "FC", "hj": "YES", "pefs": "J-019", "s_en": "COMBSN AIR FROM COMB AIR BLOWER F-0001-K-015", "s_ar": "هواء الاحتراق من المنفاخ F-0001-K-015", "l_en": "HEATER GROUND FLOOR (WEST)", "l_ar": "السخان - الأرضي (غرب)" },
        { t: "TV", n: "01-TV-00085",  act: "FO", "hj": "YES", "pefs": "J-022-002", "s_en": "LP BFW TO STRIPPING STEAM SUPERHEATER", "s_ar": "مياه تغذية الغلاية (BFW) إلى محمص البخار", "l_en": "V-0004 STRUCTURE 4TH FLOOR", "l_ar": "منصة V-0004 الدور الرابع" },
        { t: "TV", n: "01-TV-00088",  act: "FC", "hj": "YES", "pefs": "J-021-001", "s_en": "COMBSN AIR FROM COMBSN AIR PREHEATER", "s_ar": "هواء الاحتراق من المسخن الأولي (Air Preheater)", "l_en": "V-0004 STRUCTURE 1ST FLOOR", "l_ar": "منصة V-0004 الدور الأول" },
        { t: "TV", n: "01-TV-00091",  act: "FC", "hj": "YES", "pefs": "J-021-002", "s_en": "TOP Pump Around BYPASS TO CRD DISTILLATION COLUMN", "s_ar": "خط تجاوز (Bypass) لدائرة التدوير العلوية", "l_en": "NEAR P-0003A/C (SOUTH SIDE)", "l_ar": "بجانب P-0003A/C (جنوب)" },
        { t: "TV", n: "01-TV-00093",  act: "FC", "hj": "YES", "pefs": "J-022-002", "s_en": "MIDDLE Pump Around BYPASS TO CRD DIST COLUMN", "s_ar": "خط تجاوز (Bypass) لدائرة التدوير الوسطى", "l_en": "V-0004 STRUCTURE 4TH FLOOR", "l_ar": "منصة V-0004 الدور الرابع" },
        { t: "TV", n: "01-TV-00095",  act: "FC", "hj": "YES", "pefs": "J-031-001", "s_en": "BOT Pump Around BYPASS TO CRD DISTILLATION COLUMN", "s_ar": "خط تجاوز (Bypass) لدائرة التدوير السفلية", "l_en": "NEAR P-0009A (SOUTH SIDE)", "l_ar": "بجانب P-0009A (جنوب)" },
        { t: "TV", n: "01-TV-00096",  act: "FC", "hj": "YES", "pefs": "J-005", "s_en": "ATM RESID TO KEROS STRIPPER REBOILR BYPASS", "s_ar": "تجاوز مخلفات التقطير إلى غلاية الكيروسين (Reboiler)", "l_en": "NEAR E-0006A/B (WEST SIDE)", "l_ar": "بجانب E-0006A/B (غرب)" },
        { t: "TV", n: "01-TV-00127",  act: "FC", "hj": "YES", "pefs": "3004", "s_en": "ATM RESID BYP FM CRD / ATM RESID EXCH E-0006A/B", "s_ar": "تجاوز مخلفات التقطير من المبادل E-0006A/B", "l_en": "01MPR-05 28XA (RACK NORTH)", "l_ar": "حامل الأنابيب (Rack) الشمالي" },
        { t: "TV", n: "01-TV-00128",  act: "FC", "hj": "YES", "pefs": "3004", "s_en": "KEROS PROD BYP FM CRD /KEROS PROD EXCH E-0010A/B", "s_ar": "تجاوز منتج الكيروسين من المبادل E-0010A/B", "l_en": "SOUTH SIDE OF E-0010A/B", "l_ar": "جنوب E-0010A/B" },
        { t: "TV", n: "01-TV-00129",  act: "FC", "hj": "YES", "pefs": "3004", "s_en": "DSL PROD BYP FM CRD FEED/DSL PROD EXCH E-0004A/B", "s_ar": "تجاوز منتج الديزل من المبادل E-0004A/B", "l_en": "BETWEEN P-0012A/B", "l_ar": "بين P-0012A/B" },
        { t: "TV", n: "01-TV-00340",  act: "FC", "hj": "YES", "pefs": "J-060", "s_en": "BOILER FEED WATER TO IP STM DESHUPTR 01-M-0002", "s_ar": "مياه الغلاية إلى مبرد البخار (Desuperheater) M-0002", "l_en": "COMPRESSOR K-0001 SHED", "l_ar": "سقيفة الضاغط K-0001" },
        { t: "TV", n: "01-TV-00418",  act: "FC", "hj": "NO",  "pefs": "J-012-001", "s_en": "CRD/ATM RESIDUE FEED/ATM RESIDUE EXCH E-0004A/B", "s_ar": "تغذية الخام/مخلفات التقطير للمبادل E-0004A/B", "l_en": "SOUTH SIDE OF E-0008A/B", "l_ar": "جنوب E-0008A/B" },
        { t: "TV", n: "01-TV-00518",  act: "FC", "hj": "YES", "pefs": "J-070", "s_en": "OFF GAS COMPRESSOR 01-K-0001 (LUBE OIL)", "s_ar": "نظام زيت التزييت لضاغط الغازات K-0001", "l_en": "COMPRESSOR K-0001 SHED", "l_ar": "سقيفة الضاغط K-0001" },
        { t: "TV", n: "01-TV-00527",  act: "FC", "hj": "YES", "pefs": "J-075", "s_en": "OFF GAS COMPRESSOR (CCW CONSOLE)", "s_ar": "نظام التبريد (CCW) لضاغط الغازات K-0001", "l_en": "COMPRESSOR K-0001 SHED", "l_ar": "سقيفة الضاغط K-0001" }
    ];

    // --- LOGIC ---
    let curLang = localStorage.getItem('cv-lang') || (navigator.language.startsWith('ar') ? 'ar' : 'en');

    document.addEventListener('DOMContentLoaded', () => {
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
             document.documentElement.setAttribute('data-theme', e.matches ? 'dark' : 'light');
             updateThemeIcon();
        });
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.setAttribute('data-theme', 'dark');
        }
        updateThemeIcon();
        applyLanguageUI();
        populateTypes();
    });

    function toggleThemeManual() {
        const html = document.documentElement;
        html.setAttribute('data-theme', html.getAttribute('data-theme') === 'dark' ? 'light' : 'dark');
        updateThemeIcon();
    }

    function updateThemeIcon() {
        const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
        const icon = document.getElementById('theme-icon');
        if(icon) icon.className = isDark ? "bi bi-moon-stars-fill" : "bi bi-sun-fill";
    }

    function toggleLanguage() {
        curLang = curLang === 'en' ? 'ar' : 'en';
        localStorage.setItem('cv-lang', curLang);
        applyLanguageUI();
        populateTypes();
        if(document.getElementById('controlNumber').value) showData();
    }

    function applyLanguageUI() {
        document.body.dir = curLang === 'ar' ? 'rtl' : 'ltr';
        const container = document.getElementById('lang-switch');
        const optEn = document.getElementById('opt-en');
        const optAr = document.getElementById('opt-ar');
        
        if (curLang === 'ar') {
            container.classList.add('ar-active'); optAr.classList.add('active'); optEn.classList.remove('active');
        } else {
            container.classList.remove('ar-active'); optEn.classList.add('active'); optAr.classList.remove('active');
        }
        
        document.querySelectorAll('[data-i18n]').forEach(el => {
            let key = el.getAttribute('data-i18n');
            if (translations[curLang][key]) el.innerText = translations[curLang][key];
        });
    }

    function getCleanNumber(fullTag) { return fullTag.split('-').pop().replace(/^0+/, ''); }
    function formatPumpCodes(text) { return text ? text.replace(/P-0*(\d+)\s*([A-Z/]*)/g, "P$1 $2") : text; }

    const typeSelect = document.getElementById('controlType');
    const numSelect = document.getElementById('controlNumber');
    const table = document.getElementById('dataTable');
    const tableBody = document.getElementById('tableBody');
    const placeholder = document.getElementById('placeholder');

    function populateTypes() {
        const selectedValue = typeSelect.value;
        typeSelect.innerHTML = `<option value="">${translations[curLang].optSelect}</option>`;
        const types = [...new Set(database.map(item => item.t))].sort();
        types.forEach(type => {
            const option = document.createElement('option');
            option.value = type;
            const label = curLang === 'ar' ? `${type} - ${translations.ar.types[type]}` : `${type} - ${translations.en.types[type]}`;
            option.textContent = label;
            typeSelect.appendChild(option);
        });
        typeSelect.value = selectedValue;
    }

    function populateNumbers() {
        const selectedType = typeSelect.value;
        numSelect.innerHTML = `<option value="">${translations[curLang].optSelectNum}</option>`;
        numSelect.disabled = true;
        table.style.display = "none";
        placeholder.style.display = "block";

        if (selectedType) {
            const filteredItems = database.filter(item => item.t === selectedType);
            filteredItems.sort((a, b) => getCleanNumber(a.n).localeCompare(getCleanNumber(b.n), undefined, {numeric: true}));
            filteredItems.forEach(item => {
                const option = document.createElement('option');
                option.value = item.n;
                option.textContent = getCleanNumber(item.n);
                numSelect.appendChild(option);
            });
            numSelect.disabled = false;
        }
    }

    function showData() {
        const selectedTag = numSelect.value;
        tableBody.innerHTML = "";
        if (selectedTag) {
            const record = database.find(item => item.n === selectedTag);
            if (record) {
                const t = translations[curLang];
                const isAr = curLang === 'ar';
                let hjDisplay = record.hj === "YES" ? `<i class="bi bi-check-circle-fill status-icon-only icon-ok"></i>` : (record.hj === "NO" ? `<i class="bi bi-x-circle-fill status-icon-only icon-no"></i>` : record.hj);
                let serviceText = formatPumpCodes(isAr ? record.s_ar : record.s_en);
                let locationText = formatPumpCodes(isAr ? record.l_ar : record.l_en);

                const rows = [
                    { label: t.h_tag, value: `<span class="tag-badge">${record.n}</span>` },
                    { label: t.h_service, value: serviceText },
                    { label: t.h_action, value: t.actions[record.act] || record.act },
                    { label: t.h_handjack, value: hjDisplay },
                    { label: t.h_pefs, value: record.pefs },
                    { label: t.h_location, value: `<i class="bi bi-geo-alt-fill text-danger me-1"></i> ` + locationText }
                ];

                rows.forEach(row => {
                    tableBody.innerHTML += `<tr><th>${row.label}</th><td>${row.value}</td></tr>`;
                });
                table.style.display = "table";
                placeholder.style.display = "none";
            }
        }
    }
</script>
</body>
</html>
